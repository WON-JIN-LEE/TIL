## 메모리상의 데이터 배치

아래 그림은 MMU(메모리 관리 장치)가 없을 때 폰 노이만 구조와 하버드 구조의 전형적인 메모리 배치를 보여준다.
유일한 차이는 하버드 구조에서는 명령어가 별도의 메모리에 존재한다는 점이다.

![](https://teamsparta.notion.site/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F8d94d289-a43e-47c9-8c01-4fead9ffc10f%2F1.png?table=block&id=5be5d399-3d1d-4fc1-8c54-3e12a3bf7b30&spaceId=83c75a39-3aba-4ba4-a792-7aefe4b07895&width=1060&userId=&cache=v2)

### 할당 방식에 따른 데이터 분류

- 정적(static) 데이터
    - 메모리의 크기를 미리 선언하여 프로그램이 실행 될 때 이미 해당 메모리의 크기가 결정되는 데이터
    
- 동적(dynamic) 데이터
    - 프로그램을 실행하기 전에는 크기를 알 수 없는 데이터
    - 사용자의 입력에 의한 동적 할당 
    (ex 메시징 시스템 : 프로그램 시작 전까지 저장해야 할 메시지 개수나 크기를 알 수 없음)

더 많은 데이터를 저장해야 할 경우 스택은 아래로 자라나는 반면, 힙은 위로 자라난다. 힙과 스택이 서로 충돌하지 않게 하는 것 이 중요하다.

## 프로그램 실행

### 라이브러리

- 특정 기능들이 **함수**나 **클래스** 등의 형태로 공개돼서 이를 가져다가 내 소프트웨어에 붙여 넣을 수 있는 것
    - 어떤 SW든 갖다 붙여 사용할 수 있게끔 **모듈화된 코드나 묶음**을 말함

- 프로그램은 라이브러리 뿐 만 아니라 여러 조각으로 이루어짐
    - 협업, 구조화 등을 이유로 프로그램을 여러 파일에 나눠서(모듈화) 개발함
    - 나눠진 조각을 하나로 연결(Link)할 방법이 필요함

 **정적 링크**

- 정적 링크 : 라이브러리를 필요한 함수가 들어있는 파일로 간주하여 프로그램의 나머지 부분과 직접 연결하고 이를 실행파일로 만든다.
- 과거에는 정적 링크 방식을 사용함

 여러 프로그램이 똑같은 라이브러리를 사용하는데, 이 코드가 실행파일 마다 들어가 있으면 메모리 낭비한다.

**동적링크**

- 정적링크 방식으로 인한 메모리 비효율을 해결하기 위해 등장
- 동적 링크 : MMU가 여러 프로그램이 같은 라이브러리를 공유할 수 있게 해주는 것


### 라이브러리와 프로그램 실행 순서

- `진입점` : 프로그램의 첫 번째 명령어가 위치한 주소
- 프로그램 실행 프로세스: 프로그램 실행 시 진입점 명령어부터 먼저 실행하는 게 아니다.
- 1.런타임 라이브러리 명령어 실행 →  2. 진입점 명령어 실행

런타임 라이브러리는 메모리 설정을 책입진다. 이 말은 
1. 스택 & 힙 영역을 설정한다는 뜻이다.
2. 정적 데이터에 위치한 데이터의 초깃값 설정
    - 데이터 초깃값은 실행 파일에 들어있고 시스템에서 메모리 할당 받은 직후 실행 파일에서 메모리로 복사돼야 한다.

### 메모리 전력 소비

- 지금까지 메모리 효율성(메모리를 얼마나 아낄 수 있는지)의 관점에서 5장을 배웠지만 메모리 효율성 뿐만 아니라 데이터를 옮길 때 소요되는 전력을 고려해야 한다.
- 특히 모바일 - 배터리 전력 고려하는 게 필요하다!
- 전력 소비와 성능 사이의 균형을 잡는 일은 몹시 어렵다. 코드를 작성할 때도 이를 염두에 두어야 한다.

